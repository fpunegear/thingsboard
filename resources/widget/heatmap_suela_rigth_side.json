{
  "fqn": "heatmap_suela_simpleheat",
  "name": "Heatmap Suela Rigth side",
  "deprecated": false,
  "image": null,
  "description": null,
  "descriptor": {
    "type": "timeseries",
    "sizeX": 8,
    "sizeY": 5,
    "resources": [
      {
        "url": "https://cdn.jsdelivr.net/npm/simpleheat@0.4.0/simpleheat.min.js",
        "isModule": false
      }
    ],
    "templateHtml": "<!--<tb-time-series-chart-widget -->\n<!--    [ctx]=\"ctx\"-->\n<!--    [widgetTitlePanel]=\"widgetTitlePanel\">-->\n<!--</tb-time-series-chart-widget>-->\n\n<!--<script src=\"https://cdn.jsdelivr.net/npm/simpleheat@0.4.0/simpleheat.min.js\"></script>-->\n<!--<div id=\"heatmapContainer\" style=\"width: 100%; height: 100%;\">-->\n<!--  <canvas id=\"heatmapCanvas\"></canvas>-->\n<!--</div>-->\n\n<!--<div id=\"heatmapContainer\" style=\"width: 100%; height: 100%; position: relative;\">-->\n<!--  <img id=\"backgroundImage\" src=\"https://www.vhv.rs/dpng/d/288-2889967_colorful-shoe-sole-template-illustration-hd-png-download.png\" style=\"position: absolute; width: 100%; height: 100%; object-fit: contain;\" />-->\n<!--  <canvas id=\"heatmapCanvas\" style=\"position: absolute; width: 100%; height: 100%;left: 0; top: 0;\"></canvas>-->\n<!--</div>-->\n\n\n<script src=\"https://cdn.jsdelivr.net/npm/simpleheat@0.4.0/simpleheat.min.js\"></script>\n<!--<div id=\"heatmapContainer\" style=\"width: 100%; height: 100%; position: relative;\">-->\n  <!--<img id=\"backgroundImage\" src=\"https://www.vhv.rs/dpng/d/288-2889967_colorful-shoe-sole-template-illustration-hd-png-download.png\" style=\"position: absolute; width: 100%; height: 100%; object-fit: contain;\" />-->\n<!--  <canvas id=\"heatmapCanvas\" style=\"position: absolute; left: 0; top: 0;\"></canvas>-->\n<!--</div>-->\n\n\n<div id=\"heatmapContainerRight\" style=\"width: 100%; height: 100%;\">\n    <img id=\"backgroundImageRight\" class=\"backgroundImageRight\" src=\"/api/images/public/5NhYCgFdZULkTRZ7xBy2omPuZlH9f1un\" alt=\"sole.png\" />\n    <!--<img id=\"backgroundImage\" src=\"https://www.vhv.rs/dpng/d/288-2889967_colorful-shoe-sole-template-illustration-hd-png-download.png\" class=\"backgroundImage\" />-->\n  <canvas id=\"heatmapCanvasRight\"></canvas>\n</div>",
    "templateCss": "/*#heatmapContainer {*/\n/*  width: 100%;*/\n/*  height: 100%;*/\n/*  position: relative;*/\n/*}*/\n\n/*#backgroundImage {*/\n/*  position: absolute;*/\n/*  width: 100%;*/\n/*  height: 100%;*/\n/*  object-fit: contain;*/\n/*}*/\n\n#heatmapCanvasRight {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\n#backgroundImageRight {\n  /*width: 100%;*/\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n",
    "controllerScript": "self.onInit = function() {\n  const canvas = document.getElementById('heatmapCanvasRight');\n  const ctx = canvas.getContext('2d');\n  let heat;\n\n  function resizeCanvas() {\n    canvas.width = canvas.clientWidth;\n    canvas.height = canvas.clientHeight;\n    if (heat) {\n      heat._width = canvas.width;\n      heat._height = canvas.height;\n    }\n  }\n\n  resizeCanvas();\n  window.addEventListener('resize', resizeCanvas);\n\n  heat = simpleheat(canvas);\n  heat.radius(30, 20);\n  heat.max(100);\n\n  self.onDataUpdated = function() {\n    const sensores = self.ctx.data[0].data;\n    if (sensores.length === 0) return;\n\n    try {\n      const payload = sensores[sensores.length - 1][1];\n      const parsed = typeof payload === 'string' ? JSON.parse(payload) : payload;\n\n      // Escalar y preparar puntos para heatmap\n      const puntos = parsed.map(p => {\n        const x = p.posicionX * 50;\n        const y = p.posicionY * 50;\n        return [x, y, p.peso];\n      });\n\n      heat.data(puntos);\n      heat.draw(0.05);\n    } catch (e) {\n      console.error('Error parsing or drawing sensor data', e);\n    }\n  };\n};\n\nself.onDestroy = function() {\n  window.removeEventListener('resize', resizeCanvas);\n};\n",
    "settingsSchema": "{\n  \"schema\": {\n    \"type\": \"object\",\n    \"title\": \"Configuración del mapa de calor\",\n    \"properties\": {\n      \"radius\": { \"type\": \"number\", \"default\": 40, \"title\": \"Radio del punto\" },\n      \"blur\": { \"type\": \"number\", \"default\": 15, \"title\": \"Desenfoque\" },\n      \"maxPeso\": { \"type\": \"number\", \"default\": 100, \"title\": \"Peso máximo\" },\n      \"opacidad\": { \"type\": \"number\", \"default\": 0.05, \"title\": \"Opacidad\" },\n      \"escalaX\": { \"type\": \"number\", \"default\": 60, \"title\": \"Escala X\" },\n      \"escalaY\": { \"type\": \"number\", \"default\": 60, \"title\": \"Escala Y\" }\n    }\n  },\n  \"form\": [\n    \"radius\", \"blur\", \"maxPeso\", \"opacidad\", \"escalaX\", \"escalaY\"\n  ]\n}\n",
    "dataKeySettingsSchema": "{\n  \"schema\": {\n    \"type\": \"object\",\n    \"title\": \"Configuración de Datos\",\n    \"properties\": {\n      \"telemetryKey\": {\n        \"type\": \"string\",\n        \"title\": \"Clave de telemetría\",\n        \"default\": \"sensores\"\n      }\n    }\n  },\n  \"form\": [\n    {\n      \"key\": \"telemetryKey\"\n    }\n  ]\n}\n",
    "latestDataKeySettingsSchema": "{}",
    "settingsDirective": "tb-time-series-chart-widget-settings",
    "dataKeySettingsDirective": "tb-time-series-chart-key-settings",
    "latestDataKeySettingsDirective": "",
    "hasBasicMode": true,
    "basicModeDirective": "tb-time-series-chart-basic-config",
    "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\",\"aggregationType\":null,\"units\":null,\"decimals\":null,\"usePostProcessing\":null,\"postFuncBody\":null},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#FFC107\",\"settings\":{\"type\":\"bar\"},\"_hash\":0.5534217244004682,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\",\"aggregationType\":null,\"units\":null,\"decimals\":null,\"usePostProcessing\":null,\"postFuncBody\":null}],\"alarmFilterConfig\":{\"statusList\":[\"ACTIVE\"]},\"latestDataKeys\":null}],\"timewindow\":{\"hideInterval\":false,\"hideLastInterval\":false,\"hideQuickInterval\":false,\"hideAggregation\":false,\"hideAggInterval\":false,\"hideTimezone\":false,\"selectedTab\":0,\"realtime\":{\"realtimeType\":0,\"timewindowMs\":60000,\"quickInterval\":\"CURRENT_DAY\",\"interval\":1000},\"aggregation\":{\"type\":\"AVG\",\"limit\":25000},\"timezone\":null},\"showTitle\":true,\"backgroundColor\":\"rgba(0, 0, 0, 0)\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"0px\",\"settings\":{\"showLegend\":true,\"legendConfig\":{\"direction\":\"column\",\"position\":\"top\",\"sortDataKeys\":false,\"showMin\":false,\"showMax\":false,\"showAvg\":true,\"showTotal\":false,\"showLatest\":false},\"thresholds\":[],\"dataZoom\":true,\"stack\":false,\"yAxis\":{\"show\":true,\"label\":\"\",\"labelFont\":{\"family\":\"Roboto\",\"size\":12,\"sizeUnit\":\"px\",\"style\":\"normal\",\"weight\":\"600\",\"lineHeight\":\"1\"},\"labelColor\":\"rgba(0, 0, 0, 0.54)\",\"position\":\"left\",\"showTickLabels\":true,\"tickLabelFont\":{\"family\":\"Roboto\",\"size\":12,\"sizeUnit\":\"px\",\"style\":\"normal\",\"weight\":\"400\",\"lineHeight\":\"1\"},\"tickLabelColor\":\"rgba(0, 0, 0, 0.54)\",\"showTicks\":true,\"ticksColor\":\"rgba(0, 0, 0, 0.54)\",\"showLine\":true,\"lineColor\":\"rgba(0, 0, 0, 0.54)\",\"showSplitLines\":true,\"splitLinesColor\":\"rgba(0, 0, 0, 0.12)\"},\"xAxis\":{\"show\":true,\"label\":\"\",\"labelFont\":{\"family\":\"Roboto\",\"size\":12,\"sizeUnit\":\"px\",\"style\":\"normal\",\"weight\":\"600\",\"lineHeight\":\"1\"},\"labelColor\":\"rgba(0, 0, 0, 0.54)\",\"position\":\"bottom\",\"showTickLabels\":true,\"tickLabelFont\":{\"family\":\"Roboto\",\"size\":10,\"sizeUnit\":\"px\",\"style\":\"normal\",\"weight\":\"400\",\"lineHeight\":\"1\"},\"tickLabelColor\":\"rgba(0, 0, 0, 0.54)\",\"ticksFormat\":{},\"showTicks\":true,\"ticksColor\":\"rgba(0, 0, 0, 0.54)\",\"showLine\":true,\"lineColor\":\"rgba(0, 0, 0, 0.54)\",\"showSplitLines\":true,\"splitLinesColor\":\"rgba(0, 0, 0, 0.12)\"},\"legendLabelFont\":{\"family\":\"Roboto\",\"size\":12,\"sizeUnit\":\"px\",\"style\":\"normal\",\"weight\":\"400\",\"lineHeight\":\"16px\"},\"legendLabelColor\":\"rgba(0, 0, 0, 0.76)\",\"showTooltip\":true,\"tooltipTrigger\":\"axis\",\"tooltipValueFont\":{\"family\":\"Roboto\",\"size\":12,\"sizeUnit\":\"px\",\"style\":\"normal\",\"weight\":\"500\",\"lineHeight\":\"16px\"},\"tooltipValueColor\":\"rgba(0, 0, 0, 0.76)\",\"tooltipShowDate\":true,\"tooltipDateFormat\":{\"format\":null,\"lastUpdateAgo\":false,\"custom\":false,\"auto\":true,\"autoDateFormatSettings\":{}},\"tooltipDateFont\":{\"family\":\"Roboto\",\"size\":11,\"sizeUnit\":\"px\",\"style\":\"normal\",\"weight\":\"400\",\"lineHeight\":\"16px\"},\"tooltipDateColor\":\"rgba(0, 0, 0, 0.76)\",\"tooltipDateInterval\":true,\"tooltipBackgroundColor\":\"rgba(255, 255, 255, 0.76)\",\"tooltipBackgroundBlur\":4,\"background\":{\"type\":\"color\",\"color\":\"#fff\",\"overlay\":{\"enabled\":false,\"color\":\"rgba(255,255,255,0.72)\",\"blur\":3}},\"yAxes\":{\"default\":{\"units\":null,\"decimals\":0,\"show\":true,\"label\":\"\",\"labelFont\":{\"family\":\"Roboto\",\"size\":12,\"sizeUnit\":\"px\",\"style\":\"normal\",\"weight\":\"600\",\"lineHeight\":\"1\"},\"labelColor\":\"rgba(0, 0, 0, 0.54)\",\"position\":\"left\",\"showTickLabels\":true,\"tickLabelFont\":{\"family\":\"Roboto\",\"size\":12,\"sizeUnit\":\"px\",\"style\":\"normal\",\"weight\":\"400\",\"lineHeight\":\"1\"},\"tickLabelColor\":\"rgba(0, 0, 0, 0.54)\",\"ticksFormatter\":null,\"showTicks\":true,\"ticksColor\":\"rgba(0, 0, 0, 0.54)\",\"showLine\":true,\"lineColor\":\"rgba(0, 0, 0, 0.54)\",\"showSplitLines\":true,\"splitLinesColor\":\"rgba(0, 0, 0, 0.12)\",\"id\":\"default\",\"order\":0}},\"noAggregationBarWidthSettings\":{\"strategy\":\"group\",\"groupWidth\":{\"relative\":true,\"relativeWidth\":2,\"absoluteWidth\":1000},\"barWidth\":{\"relative\":true,\"relativeWidth\":2,\"absoluteWidth\":1000}},\"animation\":{\"animation\":true,\"animationThreshold\":2000,\"animationDuration\":500,\"animationEasing\":\"cubicOut\",\"animationDelay\":0,\"animationDurationUpdate\":300,\"animationEasingUpdate\":\"cubicOut\",\"animationDelayUpdate\":0},\"padding\":\"12px\"},\"title\":\"Time series chart\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":null,\"mobileHeight\":null,\"configMode\":\"basic\",\"actions\":{},\"showTitleIcon\":false,\"titleIcon\":\"thermostat\",\"iconColor\":\"#1F6BDD\",\"useDashboardTimewindow\":false,\"displayTimewindow\":true,\"titleFont\":{\"size\":16,\"sizeUnit\":\"px\",\"family\":\"Roboto\",\"weight\":\"500\",\"style\":\"normal\",\"lineHeight\":\"24px\"},\"titleColor\":\"rgba(0, 0, 0, 0.87)\",\"titleTooltip\":\"\",\"widgetStyle\":{},\"widgetCss\":\"\",\"pageSize\":1024,\"units\":\"\",\"decimals\":null,\"noDataDisplayMessage\":\"\",\"timewindowStyle\":{\"showIcon\":false,\"iconSize\":\"24px\",\"icon\":null,\"iconPosition\":\"left\",\"font\":{\"size\":12,\"sizeUnit\":\"px\",\"family\":\"Roboto\",\"weight\":\"400\",\"style\":\"normal\",\"lineHeight\":\"16px\"},\"color\":\"rgba(0, 0, 0, 0.38)\",\"displayTypePrefix\":true},\"margin\":\"0px\",\"borderRadius\":\"0px\",\"iconSize\":\"0px\"}"
  },
  "scada": false,
  "tags": null
}